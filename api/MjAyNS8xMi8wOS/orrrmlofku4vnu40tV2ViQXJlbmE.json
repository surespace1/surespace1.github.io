{"title":"论文介绍:WebArena","date":"2025-12-09T02:40:56.000Z","date_formatted":{"ll":"2025年12月9日","L":"2025/12/09","MM-DD":"12-09"},"link":"2025/12/09/论文介绍-WebArena","comments":true,"tags":["paper reading"],"categories":["paper"],"updated":"2025-12-12T02:39:18.343Z","content":"<h1 id=\"webarena:-a-realistic-web-environment-for-building-autonomous-agents（iclr-2024）\">WebArena: A Realistic Web Environment for Building Autonomous Agents（ICLR 2024）<a title=\"#webarena:-a-realistic-web-environment-for-building-autonomous-agents（iclr-2024）\" href=\"#webarena:-a-realistic-web-environment-for-building-autonomous-agents（iclr-2024）\"></a></h1>\n<p>地址：<a href=\"https://webarena.dev/\" target=\"_blank\">https://webarena.dev/</a></p>\n<h2 id=\"概述\">概述<a title=\"#概述\" href=\"#概述\"></a></h2>\n<p>WebArena 是一个用于构建自主代理(autonomous agents)的现实Web环境。它提供了一个独立的、可自托管的Web环境，让研究人员可以测试和评估Web自动化代理的能力。该项目解决了在真实Web环境中训练和评估AI代理的问题。</p>\n<p>解决问题：</p>\n<ul>\n<li><strong>现实性不足的现有环境</strong>：多数测试环境属于抽象、简化版本，难以真实映射实际 Web 场景，任务也缺乏多样性和复杂性。</li>\n<li><strong>缺乏功能层级验证</strong>：之前的方法常基于行为序列或文本匹配进行评估，忽略是否真正实现了目标。WebArena 提供了功能性验证器，确保任务结果实际符合预期。</li>\n</ul>\n<p>输入：tell me all sub reddits starting with character ‘a’</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;sites&quot;</span>: [<span class=\"string\">&quot;shopping&quot;</span>],</span><br><span class=\"line\">  <span class=\"string\">&quot;task_id&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;require_login&quot;</span>: true,</span><br><span class=\"line\">  <span class=\"string\">&quot;storage_state&quot;</span>: <span class=\"string\">&quot;./.auth/shopping_state.json&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;start_url&quot;</span>: <span class=\"string\">&quot;http://shop.example.com:7770&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;intent&quot;</span>: <span class=\"string\">&quot;tell me all sub reddits starting with character &#x27;a&#x27;&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;eval&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;eval_types&quot;</span>: [<span class=\"string\">&quot;string_match&quot;</span>, <span class=\"string\">&quot;url_match&quot;</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;reference_answers&quot;</span>: [<span class=\"string\">&quot;Thank you for your purchase!&quot;</span>],</span><br><span class=\"line\">    <span class=\"string\">&quot;reference_url&quot;</span>: <span class=\"string\">&quot;http://shop.example.com:7770/checkout/success&quot;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[</span><br><span class=\"line\">    <span class=\"comment\"># --- Step 0: 初始状态 (StateInfo after env.reset()) ---</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;observation&quot;</span>: &#123; <span class=\"comment\"># 无障碍字符串表示，包含了元素ID、类型、名称和属性。</span></span><br><span class=\"line\">            <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&quot;&quot;[4] RootWebArea &#x27;Reddit - Dive into anything&#x27; focused: True</span></span><br><span class=\"line\"><span class=\"string\">        [12] link &#x27;Log In&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [15] link &#x27;Sign Up&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [20] textbox &#x27;Search Reddit&#x27; required: False</span></span><br><span class=\"line\"><span class=\"string\">        [25] link &#x27;Popular&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [28] link &#x27;All&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [31] link &#x27;Random&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [34] link &#x27;Forums&#x27;</span></span><br><span class=\"line\"><span class=\"string\">URL: http://metis.lti.cs.cmu.edu:9999/&quot;&quot;&quot;</span></span><br><span class=\"line\">            <span class=\"comment\"># 其他观察类型如 &#x27;screenshot&#x27; (numpy array) 会在这里，但为了简洁省略</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">&quot;info&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;page&quot;</span>: &#123;</span><br><span class=\"line\">                <span class=\"string\">&quot;url&quot;</span>: <span class=\"string\">&quot;http://metis.lti.cs.cmu.edu:9999/&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;title&quot;</span>: <span class=\"string\">&quot;Reddit - Dive into anything&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;viewport_size&quot;</span>: &#123;<span class=\"string\">&quot;width&quot;</span>: <span class=\"number\">1280</span>, <span class=\"string\">&quot;height&quot;</span>: <span class=\"number\">720</span>&#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"string\">&quot;active_tabs&quot;</span>: [<span class=\"number\">0</span>], <span class=\"comment\"># 当前活跃的tab索引</span></span><br><span class=\"line\">            <span class=\"string\">&quot;tab_urls&quot;</span>: [<span class=\"string\">&quot;http://metis.lti.cs.cmu.edu:9999/&quot;</span>], <span class=\"comment\"># 所有tab的URL</span></span><br><span class=\"line\">            <span class=\"string\">&quot;action_history&quot;</span>: [<span class=\"string\">&quot;None&quot;</span>], <span class=\"comment\"># 代理执行的动作历史（字符串形式）</span></span><br><span class=\"line\">            <span class=\"string\">&quot;elapsed_time&quot;</span>: <span class=\"number\">0.0</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;num_steps&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;history&quot;</span>: [] <span class=\"comment\"># 浏览器历史记录</span></span><br><span class=\"line\">            <span class=\"comment\"># 其他信息，如浏览器配置等</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># --- Step 1: 代理执行动作 (Action: click [34]) ---</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;action_type&quot;</span>: <span class=\"number\">6</span>, <span class=\"comment\"># ActionTypes.CLICK 的整数值</span></span><br><span class=\"line\">        <span class=\"string\">&quot;coords&quot;</span>: [<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>], <span class=\"comment\"># 对于ID-based click，coords通常为0</span></span><br><span class=\"line\">        <span class=\"string\">&quot;element_role&quot;</span>: <span class=\"number\">0</span>, <span class=\"comment\"># 元素的角色ID，这里可能不重要，因为是ID-based</span></span><br><span class=\"line\">        <span class=\"string\">&quot;element_name&quot;</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"comment\"># 元素名称，这里可能不重要</span></span><br><span class=\"line\">        <span class=\"string\">&quot;text&quot;</span>: [], <span class=\"comment\"># 对于click动作，text为空</span></span><br><span class=\"line\">        <span class=\"string\">&quot;page_number&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;url&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nth&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;element_id&quot;</span>: <span class=\"string\">&quot;34&quot;</span>, <span class=\"comment\"># 目标元素的ID</span></span><br><span class=\"line\">        <span class=\"string\">&quot;direction&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;key_comb&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;pw_code&quot;</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"comment\"># Playwright代码，如果动作是直接由Playwright代码生成</span></span><br><span class=\"line\">        <span class=\"string\">&quot;answer&quot;</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"comment\"># 对于非stop动作，answer为空</span></span><br><span class=\"line\">        <span class=\"string\">&quot;raw_prediction&quot;</span>: <span class=\"string\">&quot;Let&#x27;s think step-by-step. ... In summary, the next action I will perform is ‍```click [34]‍```&quot;</span> <span class=\"comment\"># 模型的原始输出</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># --- Step 2: 新状态 (StateInfo after env.step(click_action)) ---</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;observation&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&quot;&quot;[4] RootWebArea &#x27;Forums - Reddit&#x27; focused: True</span></span><br><span class=\"line\"><span class=\"string\">        [12] link &#x27;Home&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [15] link &#x27;Alphabetical&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [20] link &#x27;Newest&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [25] link &#x27;Top&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [30] link &#x27;announcements&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [31] link &#x27;Art&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [32] link &#x27;AskReddit&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [33] link &#x27;askscience&#x27;</span></span><br><span class=\"line\"><span class=\"string\">        [33] link &#x27;aww&#x27;</span></span><br><span class=\"line\"><span class=\"string\">URL: http://metis.lti.cs.cmu.edu:9999/forums&quot;&quot;&quot;</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">&quot;info&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;page&quot;</span>: &#123;</span><br><span class=\"line\">                <span class=\"string\">&quot;url&quot;</span>: <span class=\"string\">&quot;http://metis.lti.cs.cmu.edu:9999/forums&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;title&quot;</span>: <span class=\"string\">&quot;Forums - Reddit&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;viewport_size&quot;</span>: &#123;<span class=\"string\">&quot;width&quot;</span>: <span class=\"number\">1280</span>, <span class=\"string\">&quot;height&quot;</span>: <span class=\"number\">720</span>&#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"string\">&quot;active_tabs&quot;</span>: [<span class=\"number\">0</span>],</span><br><span class=\"line\">            <span class=\"string\">&quot;tab_urls&quot;</span>: [<span class=\"string\">&quot;http://metis.lti.cs.cmu.edu:9999/forums&quot;</span>],</span><br><span class=\"line\">            <span class=\"string\">&quot;action_history&quot;</span>: [<span class=\"string\">&quot;click [34]&quot;</span>],</span><br><span class=\"line\">            <span class=\"string\">&quot;elapsed_time&quot;</span>: <span class=\"number\">2.5</span>, <span class=\"comment\"># 假设经过了2.5秒</span></span><br><span class=\"line\">            <span class=\"string\">&quot;num_steps&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;history&quot;</span>: [<span class=\"string\">&quot;http://metis.lti.cs.cmu.edu:9999/&quot;</span>]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># --- Step 3: 代理执行动作 (Action: stop [&quot;announcements Art AskReddit askscience aww&quot;]) ---</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;action_type&quot;</span>: <span class=\"number\">17</span>, <span class=\"comment\"># ActionTypes.STOP 的整数值</span></span><br><span class=\"line\">        <span class=\"string\">&quot;coords&quot;</span>: [<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>],</span><br><span class=\"line\">        <span class=\"string\">&quot;element_role&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;element_name&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;text&quot;</span>: [],</span><br><span class=\"line\">        <span class=\"string\">&quot;page_number&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;url&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;nth&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;element_id&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;direction&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;key_comb&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;pw_code&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;answer&quot;</span>: <span class=\"string\">&quot;announcements Art AskReddit askscience aww&quot;</span>, <span class=\"comment\"># 代理提交的最终答案</span></span><br><span class=\"line\">        <span class=\"string\">&quot;raw_prediction&quot;</span>: <span class=\"string\">&quot;Let&#x27;s think step-by-step. ... In summary, the next action I will perform is ‍```stop [\\&quot;announcements Art AskReddit askscience aww\\&quot;]‍```&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>数据集格式：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;sites&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">      <span class=\"string\">&quot;shopping_admin&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 涉及网站</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;task_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">0</span><span class=\"punctuation\">,</span> </span><br><span class=\"line\">    <span class=\"attr\">&quot;require_login&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span> <span class=\"comment\">// 是否需要登录</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;storage_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;./.auth/shopping_admin_state.json&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 登录状态文件</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;start_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;__SHOPPING_ADMIN__&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 起始url</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;geolocation&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">null</span></span><span class=\"punctuation\">,</span> <span class=\"comment\">// 地理位置设置 &#123;&quot;latitude&quot;:xx, &quot;longitude&quot;:xx&#125;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;intent_template&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;What is the top-&#123;&#123;n&#125;&#125; best-selling product in &#123;&#123;year&#125;&#125;&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 任务描述</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;instantiation_dict&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;n&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;year&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">2022</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 模板变量字典</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;intent&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;What is the top-1 best-selling product in 2022&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 最终任务描述</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;require_reset&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">false</span></span><span class=\"punctuation\">,</span> <span class=\"comment\">// 任务完成后是否需要重置</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;eval&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span> <span class=\"comment\">// 评估标准</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;eval_types&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"string\">&quot;string_match&quot;</span></span><br><span class=\"line\">      <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 评估类型列表</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;reference_answers&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;exact_match&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Quest Lumaflex\\u2122 Band&quot;</span></span><br><span class=\"line\">      <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 参考答案列表</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;reference_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 最终的url</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;program_html&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 程序化验证规则</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;string_note&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;reference_answer_raw_annotation&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Quest Lumaflex\\u2122 Band&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;intent_template_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">279</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;sites&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;reddit&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 任务涉及的网站列表，例如 [&quot;reddit&quot;, &quot;shopping&quot;]</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;task_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 任务的唯一数字ID</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;require_login&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span> <span class=\"comment\">// 布尔值，指示任务是否需要用户登录</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;storage_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;./.auth/reddit_state.json&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 如果需要登录，这是包含登录凭据（如cookies）的文件路径</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;start_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;http://metis.lti.cs.cmu.edu:9999/&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 代理开始任务时浏览器加载的初始URL</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;geolocation&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">null</span></span><span class=\"punctuation\">,</span> <span class=\"comment\">// 可选字段，如果任务需要地理位置信息，则在此指定</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;intent_template&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;tell me all subreddits starting with character &#x27;&#123;&#123;character&#125;&#125;&#x27;&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 任务意图的模板字符串，包含占位符</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;instantiation_dict&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;character&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;a&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 字典，用于填充 `intent_template` 中的占位符</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;intent&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;tell me all subreddits starting with character &#x27;a&#x27;&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 最终生成的、代理需要理解和完成的具体任务指令</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;require_reset&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">false</span></span><span class=\"punctuation\">,</span> <span class=\"comment\">// 布尔值，指示在任务开始前是否需要重置后端环境（例如清空数据库）</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;eval&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span> <span class=\"comment\">// 评估任务完成情况的配置</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;eval_types&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;string_match&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 评估类型，可以是 &quot;string_match&quot;（字符串匹配）、&quot;url_exact_match&quot;（URL精确匹配）、&quot;html_content_exact_match&quot;（HTML内容精确匹配）等</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;reference_answers&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;announcements Art AskReddit askscience aww&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 如果 `eval_types` 是 &quot;string_match&quot;，这是期望的正确答案列表</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;reference_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 如果 `eval_types` 涉及URL，这是期望的最终URL</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;program_html&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span> <span class=\"comment\">// 更复杂的评估逻辑，例如检查特定URL的HTML内容是否包含某些元素</span></span><br><span class=\"line\">            <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">                <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                <span class=\"attr\">&quot;required_contents&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">            <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">        <span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;reference_action_sequence&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span> <span class=\"comment\">// 一个可选的、人类或专家完成任务的参考动作序列，用于调试或作为基准</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;action_set_tag&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;playwright&quot;</span><span class=\"punctuation\">,</span> <span class=\"comment\">// 动作序列的类型，例如 &quot;playwright&quot;</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;action_sequence&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span> <span class=\"comment\">// 具体的动作列表，使用 Playwright 语法</span></span><br><span class=\"line\">            <span class=\"string\">&quot;page.get_by_role(\\&quot;link\\&quot;, name=\\&quot;Forums\\&quot;).click()&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"string\">&quot;page.get_by_role(\\&quot;link\\&quot;, name=\\&quot;Alphabetical\\&quot;).click()&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"string\">&quot;page.stop(\\&quot;announcements Art AskReddit askscience aww\\&quot;)&quot;</span> <span class=\"comment\">// 停止动作，并提交最终答案</span></span><br><span class=\"line\">        <span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>评价指标：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Level <span class=\"number\">1</span><span class=\"punctuation\">:</span> 基础成功率</span><br><span class=\"line\"> basic_success = <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;task_completion&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;任务是否完成&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;correctness&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;答案是否正确&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;efficiency&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;步骤数量是否合理&quot;</span></span><br><span class=\"line\"> <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> # Level <span class=\"number\">2</span><span class=\"punctuation\">:</span> 细粒度分析</span><br><span class=\"line\"> detailed_metrics = <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;navigation_accuracy&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;导航路径正确性&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;information_extraction&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;信息提取准确性&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;interaction_quality&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;交互操作质量&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;error_recovery&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;错误恢复能力&quot;</span></span><br><span class=\"line\"> <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> # Level <span class=\"number\">3</span><span class=\"punctuation\">:</span> 对比基准</span><br><span class=\"line\"> comparison_baselines = <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;human_performance&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">78.24</span><span class=\"punctuation\">,</span>      # 人类表现</span><br><span class=\"line\">     <span class=\"attr\">&quot;gpt4_cot&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">14.41</span><span class=\"punctuation\">,</span>              # GPT<span class=\"number\">-4</span> + 思维链</span><br><span class=\"line\">     <span class=\"attr\">&quot;gpt35_turbo&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">6.18</span><span class=\"punctuation\">,</span>            # GPT<span class=\"number\">-3.5</span>-Turbo</span><br><span class=\"line\">     <span class=\"attr\">&quot;random_baseline&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">0.78</span>          # 随机基线</span><br><span class=\"line\"> <span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"运行方式\">运行方式<a title=\"#运行方式\" href=\"#运行方式\"></a></h2>\n<p><img src=\"assets/image-20250815095241-8fk32nn.png\" alt=\"image\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"数据流\">数据流<a title=\"#数据流\" href=\"#数据流\"></a></h2>\n<p>以下是WebArena的一个完整数据流示例，展示从输入到输出的全过程：</p>\n<ol>\n<li>输入示例：<br>\nA) 配置文件(config_files/1.json):</li>\n</ol>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;sites&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;shopping&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;task_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;require_login&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;storage_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;./.auth/shopping_state.json&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;start_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;http://shop.example.com:7770&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;intent&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;购买价格低于$20的无线耳机&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;eval&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;eval_types&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;string_match&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;url_match&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;reference_answers&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;Thank you for your purchase!&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;reference_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;http://shop.example.com:7770/checkout/success&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>B) 命令行参数:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python run.py \\</span><br><span class=\"line\">  --instruction_path agent/prompts/jsons/p_cot_id_actree_2s.json \\</span><br><span class=\"line\">  --test_start_idx 1 \\</span><br><span class=\"line\">  --test_end_idx 2 \\</span><br><span class=\"line\">  --model gpt-3.5-turbo \\</span><br><span class=\"line\">  --observation_type accessibility_tree \\</span><br><span class=\"line\">  --result_dir results/run1</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>\n<p>执行流程:</p>\n</li>\n<li>\n<p>环境初始化:</p>\n</li>\n</ol>\n<ul>\n<li>启动无头浏览器(Chromium)</li>\n<li>加载shopping网站</li>\n<li>应用登录状态cookie</li>\n</ul>\n<ol start=\"2\">\n<li>代理决策循环:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sequenceDiagram</span><br><span class=\"line\">    participant Agent</span><br><span class=\"line\">    participant Env</span><br><span class=\"line\">    Agent-&gt;&gt;Env: 初始观察请求</span><br><span class=\"line\">    Env-&gt;&gt;Agent: 返回页面可访问性树</span><br><span class=\"line\">    Agent-&gt;&gt;LLM: 发送提示(任务目标+观察)</span><br><span class=\"line\">    LLM-&gt;&gt;Agent: 返回动作&quot;点击搜索框&quot;</span><br><span class=\"line\">    Agent-&gt;&gt;Env: 执行动作</span><br><span class=\"line\">    Env-&gt;&gt;Agent: 返回新观察</span><br><span class=\"line\">    loop 直到任务完成</span><br><span class=\"line\">        Agent-&gt;&gt;LLM: 发送更新后的提示</span><br><span class=\"line\">        LLM-&gt;&gt;Agent: 返回下一个动作</span><br><span class=\"line\">        Agent-&gt;&gt;Env: 执行动作</span><br><span class=\"line\">    end</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>输出示例:<br>\nA) 轨迹文件(results/run1/1.html):</li>\n</ol>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 简化的轨迹内容 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;trajectory&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;step&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>Step 1<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;screenshots/1.png&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Action: click [id=&quot;search_box&quot;]<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">pre</span>&gt;</span>可访问性树: search_box [edit text]<span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;step&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>Step 2<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;screenshots/2.png&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Action: type &quot;wireless earphones under $20&quot;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- ... --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;result&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Final URL: http://shop.example.com:7770/checkout/success<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Evaluation: PASS (matched reference URL and answer)<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>B) 控制台输出:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Config file]: config_files/1.json</span><br><span class=\"line\">[Intent]: 购买价格低于$20的无线耳机</span><br><span class=\"line\">[Step 1] Action: click [id=&quot;search_box&quot;]</span><br><span class=\"line\">[Step 2] Action: type &quot;wireless earphones under $20&quot;</span><br><span class=\"line\">[Step 3] Action: click [id=&quot;search_button&quot;]</span><br><span class=\"line\">...</span><br><span class=\"line\">[Result] (PASS) config_files/1.json</span><br><span class=\"line\">Average score: 1.0</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li>关键数据转换:</li>\n</ol>\n<ul>\n<li>输入自然语言任务 → 转化为结构化动作序列</li>\n<li>页面状态(HTML/DOM) → 可访问性树表示</li>\n<li>代理决策 → Playwright可执行命令</li>\n<li>最终状态 → 与参考答案比对评估</li>\n</ul>\n<h3 id=\"数据转化步骤\">数据转化步骤<a title=\"#数据转化步骤\" href=\"#数据转化步骤\"></a></h3>\n<p>以下是WebArena中关键数据转换步骤的详细说明：</p>\n<ol>\n<li>自然语言任务 → 结构化动作序列<br>\n转换过程：</li>\n</ol>\n<ul>\n<li>\n<p>输入示例：“购买价格低于$20的无线耳机”</p>\n</li>\n<li>\n<p>代理处理流程：<br>\na) 解析任务关键词：</p>\n<ul>\n<li>动作类型：购买</li>\n<li>目标物品：无线耳机</li>\n<li>条件：价格&lt;$20<br>\nb) 生成动作模板：</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[</span><br><span class=\"line\">    <span class=\"string\">&quot;在搜索框输入&#x27;wireless earphones under $20&#x27;&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;点击第一个符合条件的商品&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;点击&#x27;加入购物车&#x27;&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;点击&#x27;结算&#x27;&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;填写收货信息&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;点击&#x27;确认购买&#x27;&quot;</span></span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<p>c) 转化为Playwright指令：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[</span><br><span class=\"line\">    <span class=\"string\">&quot;page.fill(&#x27;#search&#x27;, &#x27;wireless earphones under $20&#x27;)&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;page.click(&#x27;.product:first-child&#x27;)&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;page.click(&#x27;#add-to-cart&#x27;)&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;...&quot;</span></span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ol start=\"2\">\n<li>HTML DOM → 可访问性树<br>\n转换示例：<br>\n原始HTML:</li>\n</ol>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;search_box&quot;</span> <span class=\"attr\">role</span>=<span class=\"string\">&quot;searchbox&quot;</span> <span class=\"attr\">aria-label</span>=<span class=\"string\">&quot;产品搜索&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>转换后的可访问性树:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;role&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;searchbox&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;产品搜索&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;children&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;role&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;textbox&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;value&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>代理决策 → Playwright命令<br>\nLLM输出示例：</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">思考：需要先找到搜索框</span><br><span class=\"line\">动作：click [id=&quot;search_box&quot;]</span><br></pre></td></tr></table></figure>\n<p>转换流程：<br>\na) 解析动作描述：</p>\n<ul>\n<li>动作类型：click</li>\n<li>目标元素：id=“search_box”<br>\nb) 生成Playwright指令：</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">action = &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;action_type&quot;</span>: <span class=\"string\">&quot;click&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;element_id&quot;</span>: <span class=\"string\">&quot;search_box&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;raw_prediction&quot;</span>: <span class=\"string\">&quot;click [id=\\&quot;search_box\\&quot;]&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>c) 执行对应代码：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">page.click(<span class=\"string\">&#x27;#search_box&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li>\n<p>页面状态 → 观察文本<br>\n处理流程：<br>\na) 获取当前页面HTML/可访问性树<br>\nb) 提取关键信息：</p>\n<ul>\n<li>可见文本内容</li>\n<li>交互元素属性</li>\n<li>页面标题/URL<br>\nc) 过滤噪声内容(广告、导航栏等)<br>\nd) 生成观察摘要：</li>\n</ul>\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">当前页面：商品搜索结果页</span><br><span class=\"line\">可见元素：</span><br><span class=\"line\">- [1] 商品1: 无线耳机A ($15.99) [加入购物车]</span><br><span class=\"line\">- [2] 商品2: 无线耳机B ($21.99) [加入购物车]</span><br><span class=\"line\">- 搜索框[可编辑]</span><br><span class=\"line\">- 购物车按钮[可点击]</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>最终状态评估<br>\n评估流程：<br>\na) 检查最终URL是否匹配参考URL</p>\n<ul>\n<li>实际URL: <a href=\"http://shop.example.com/checkout/success\" target=\"_blank\">http://shop.example.com/checkout/success</a></li>\n<li>参考URL: <a href=\"http://shop.example.com/checkout/success\" target=\"_blank\">http://shop.example.com/checkout/success</a> → 匹配<br>\nb) 检查页面内容是否包含参考答案：</li>\n<li>实际内容：“Thank you for your purchase!”</li>\n<li>参考答案：[“Thank you for your purchase!”] → 包含<br>\nc) 综合评估结果：PASS</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"详细流程\">详细流程<a title=\"#详细流程\" href=\"#详细流程\"></a></h3>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> 输入格式</span><br><span class=\"line\"></span><br><span class=\"line\"> 环境观察空间 (Observation Space)</span><br><span class=\"line\"></span><br><span class=\"line\"> # 观察数据结构</span><br><span class=\"line\"> obs = <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;text&quot;</span><span class=\"punctuation\">:</span> accessibility_tree_string<span class=\"punctuation\">,</span>  # 可访问性树文本表示</span><br><span class=\"line\">     <span class=\"attr\">&quot;image&quot;</span><span class=\"punctuation\">:</span> screenshot_array<span class=\"punctuation\">,</span>         # 页面截图(可选)</span><br><span class=\"line\"> <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> # 可访问性树示例格式</span><br><span class=\"line\"> <span class=\"string\">&quot;&quot;</span><span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\"> [4] RootWebArea &#x27;Projects · Dashboard · GitLab&#x27; focused: True</span></span><br><span class=\"line\"><span class=\"string\">     [12] link &#x27;Skip to content&#x27;</span></span><br><span class=\"line\"><span class=\"string\">     [28] link &#x27;Dashboard&#x27;</span></span><br><span class=\"line\"><span class=\"string\">     [63] textbox &#x27;Search GitLab&#x27; required: False</span></span><br><span class=\"line\"><span class=\"string\">     [79] link &#x27;Create new...&#x27;</span></span><br><span class=\"line\"><span class=\"string\">     [95] link &#x27;Issues&#x27;</span></span><br><span class=\"line\"><span class=\"string\">         [97] generic &#x27;13 assigned issues&#x27;</span></span><br><span class=\"line\"><span class=\"string\"> &quot;</span><span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> 任务配置格式</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;sites&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;reddit&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;task_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;require_login&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;storage_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;./.auth/reddit_state.json&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;start_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;http://reddit.com/&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;intent&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;tell me all subreddits starting with character &#x27;a&#x27;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">     <span class=\"attr\">&quot;eval&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">         <span class=\"attr\">&quot;eval_types&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;string_match&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">         <span class=\"attr\">&quot;reference_answers&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;announcements Art AskReddit askscience aww&quot;</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">     <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"> <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> 模型输入提示格式</span><br><span class=\"line\"></span><br><span class=\"line\"> OBSERVATION<span class=\"punctuation\">:</span></span><br><span class=\"line\"> <span class=\"punctuation\">[</span><span class=\"number\">164</span><span class=\"punctuation\">]</span> textbox &#x27;Search&#x27; focused<span class=\"punctuation\">:</span> True required<span class=\"punctuation\">:</span> False</span><br><span class=\"line\"> <span class=\"punctuation\">[</span><span class=\"number\">171</span><span class=\"punctuation\">]</span> button &#x27;Go&#x27;</span><br><span class=\"line\"> <span class=\"punctuation\">[</span><span class=\"number\">174</span><span class=\"punctuation\">]</span> link &#x27;Find directions between two points&#x27;</span><br><span class=\"line\"> URL<span class=\"punctuation\">:</span> http<span class=\"punctuation\">:</span><span class=\"comment\">//openstreetmap.org</span></span><br><span class=\"line\"> OBJECTIVE<span class=\"punctuation\">:</span> Show me the restaurants near CMU</span><br><span class=\"line\"> PREVIOUS ACTION<span class=\"punctuation\">:</span> None</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">2.</span> 输出格式</span><br><span class=\"line\"></span><br><span class=\"line\"> 动作空间定义</span><br><span class=\"line\"></span><br><span class=\"line\"> class Action(TypedDict)<span class=\"punctuation\">:</span></span><br><span class=\"line\">     action_type<span class=\"punctuation\">:</span> int           # 动作类型ID</span><br><span class=\"line\">     coords<span class=\"punctuation\">:</span> np.ndarray        # 坐标信息</span><br><span class=\"line\">     element_role<span class=\"punctuation\">:</span> int         # 元素角色</span><br><span class=\"line\">     element_name<span class=\"punctuation\">:</span> str         # 元素名称</span><br><span class=\"line\">     text<span class=\"punctuation\">:</span> list<span class=\"punctuation\">[</span>int<span class=\"punctuation\">]</span>           # 文本输入(token化)</span><br><span class=\"line\">     page_number<span class=\"punctuation\">:</span> int          # 页面编号</span><br><span class=\"line\">     url<span class=\"punctuation\">:</span> str                  # 目标URL</span><br><span class=\"line\">     element_id<span class=\"punctuation\">:</span> str           # 元素ID</span><br><span class=\"line\">     direction<span class=\"punctuation\">:</span> str            # 滚动方向</span><br><span class=\"line\">     key_comb<span class=\"punctuation\">:</span> str            # 按键组合</span><br><span class=\"line\">     answer<span class=\"punctuation\">:</span> str              # 最终答案</span><br><span class=\"line\"></span><br><span class=\"line\"> 动作类型</span><br><span class=\"line\"></span><br><span class=\"line\"> class ActionTypes(IntEnum)<span class=\"punctuation\">:</span></span><br><span class=\"line\">     CLICK = <span class=\"number\">0</span>          # 点击</span><br><span class=\"line\">     TYPE = <span class=\"number\">1</span>           # 输入文本</span><br><span class=\"line\">     SCROLL = <span class=\"number\">2</span>         # 滚动</span><br><span class=\"line\">     HOVER = <span class=\"number\">3</span>          # 悬停</span><br><span class=\"line\">     KEY_PRESS = <span class=\"number\">4</span>      # 按键</span><br><span class=\"line\">     GOTO_URL = <span class=\"number\">5</span>       # 导航到URL</span><br><span class=\"line\">     NEW_TAB = <span class=\"number\">6</span>        # 新标签页</span><br><span class=\"line\">     PAGE_CLOSE = <span class=\"number\">7</span>     # 关闭页面</span><br><span class=\"line\">     GO_BACK = <span class=\"number\">8</span>        # 后退</span><br><span class=\"line\">     GO_FORWARD = <span class=\"number\">9</span>     # 前进</span><br><span class=\"line\">     PAGE_FOCUS = <span class=\"number\">10</span>    # 页面聚焦</span><br><span class=\"line\">     STOP = <span class=\"number\">11</span>          # 停止(完成任务)</span><br><span class=\"line\"></span><br><span class=\"line\"> 模型输出格式</span><br><span class=\"line\"></span><br><span class=\"line\"> Let&#x27;s think step-by-step. This page has a search box whose ID is <span class=\"punctuation\">[</span><span class=\"number\">164</span><span class=\"punctuation\">]</span>.</span><br><span class=\"line\"> According to the nominatim rule of openstreetmap<span class=\"punctuation\">,</span> I can search for the</span><br><span class=\"line\"> restaurants near a location by <span class=\"string\">&quot;restaurants near&quot;</span>. I can submit my typing</span><br><span class=\"line\"> by pressing the Enter afterwards.</span><br><span class=\"line\"></span><br><span class=\"line\"> In summary<span class=\"punctuation\">,</span> the next action I will perform is ‍```type <span class=\"punctuation\">[</span><span class=\"number\">164</span><span class=\"punctuation\">]</span> <span class=\"punctuation\">[</span>restaurants near CMU<span class=\"punctuation\">]</span> <span class=\"punctuation\">[</span><span class=\"number\">1</span><span class=\"punctuation\">]</span>‍```</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">3.</span> 完整数据流 Pipeline</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">3.1</span> 初始化阶段</span><br><span class=\"line\"></span><br><span class=\"line\"> 环境配置 → 浏览器环境初始化 → 任务配置加载 → 页面导航</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">3.2</span> 观察-决策-执行循环</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">1.</span> 页面观察获取</span><br><span class=\"line\">    └── 可访问性树解析 → HTML内容提取 → 截图生成(可选)</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">2.</span> 提示构造</span><br><span class=\"line\">    └── 观察信息 + 任务目标 + 历史动作 → 模型输入提示</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">3.</span> 模型推理</span><br><span class=\"line\">    └── LLM处理 → 生成推理文本 → 动作字符串输出</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">4.</span> 动作解析</span><br><span class=\"line\">    └── 正则匹配提取 → 动作验证 → 动作对象创建</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">5.</span> 动作执行</span><br><span class=\"line\">    └── 浏览器操作 → 页面状态更新 → 新观察获取</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">3.3</span> 评估阶段</span><br><span class=\"line\"></span><br><span class=\"line\"> 轨迹收集 → 评估器路由 → 多维度评估 → 得分计算</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">4.</span> 关键数据转换</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">4.1</span> 观察处理</span><br><span class=\"line\"></span><br><span class=\"line\"> - 可访问性树 → 结构化文本表示</span><br><span class=\"line\"> - Token截断 → 限制最大观察长度</span><br><span class=\"line\"> - URL映射 → 真实网站与本地环境转换</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">4.2</span> 动作处理</span><br><span class=\"line\"></span><br><span class=\"line\"> - 字符串解析 → 结构化动作对象</span><br><span class=\"line\"> - ID动态匹配 → 处理动态元素ID</span><br><span class=\"line\"> - 坐标转换 → 元素定位与点击坐标</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">4.3</span> 轨迹管理</span><br><span class=\"line\"></span><br><span class=\"line\"> trajectory = <span class=\"punctuation\">[</span></span><br><span class=\"line\">     state_info_1<span class=\"punctuation\">,</span>    # 观察状态</span><br><span class=\"line\">     action_1<span class=\"punctuation\">,</span>        # 执行动作</span><br><span class=\"line\">     state_info_2<span class=\"punctuation\">,</span>    # 新观察状态</span><br><span class=\"line\">     action_2<span class=\"punctuation\">,</span>        # 下一个动作</span><br><span class=\"line\">     ...</span><br><span class=\"line\">     stop_action      # 任务结束</span><br><span class=\"line\"> <span class=\"punctuation\">]</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"number\">5.</span> 数据格式特点</span><br><span class=\"line\"></span><br><span class=\"line\"> - 结构化观察：使用可访问性树提供语义丰富的页面表示</span><br><span class=\"line\"> - 自然语言动作：使用类似click <span class=\"punctuation\">[</span><span class=\"number\">123</span><span class=\"punctuation\">]</span>的直观动作格式</span><br><span class=\"line\"> - 多模态支持：同时支持文本和图像观察</span><br><span class=\"line\"> - 动态适应：处理网页元素的动态变化</span><br><span class=\"line\"> - 可追踪性：完整记录决策过程和执行轨迹</span><br><span class=\"line\"></span><br><span class=\"line\"> 这种设计使得WebArena能够为Web智能体提供标准化、可重现的训练和评估环境。</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","prev":{"title":"Docker教程：Dockerfile","link":"2025/12/14/Docker教程：Dockerfile"},"next":{"title":"Git 基本用法与常见问题排查","link":"2025/10/16/git基本用法"},"plink":"http://example.com/2025/12/09/论文介绍-WebArena/","toc":[{"id":"webarena:-a-realistic-web-environment-for-building-autonomous-agents（iclr-2024）","title":"WebArena: A Realistic Web Environment for Building Autonomous Agents（ICLR 2024）","index":"1","children":[{"id":"概述","title":"概述","index":"1.1"},{"id":"运行方式","title":"运行方式","index":"1.2"},{"id":"数据流","title":"数据流","index":"1.3","children":[{"id":"数据转化步骤","title":"数据转化步骤","index":"1.3.1"},{"id":"详细流程","title":"详细流程","index":"1.3.2"}]}]}],"reward":true,"copyright":{"custom":"copyright：自由转载-非商用-禁止演绎-保持署名（CC BY-NC-ND 4.0）"},"reading_time":"3706 words in 25 min"}